BootStrap: docker
From: nvidia/cuda:10.0-cudnn7-runtime-ubuntu16.04

%help
    base recipe: https://github.com/NIH-HPC/singularity-examples

#---------------------------------------------------------------------
%labels
#---------------------------------------------------------------------
MAINTAINER Jongsu Kim

#---------------------------------------------------------------------
%environment
#---------------------------------------------------------------------
export PATH=/bin:/usr/bin:/usr/local/bin:/usr/local/cuda/bin:

#---------------------------------------------------------------------
%post
#---------------------------------------------------------------------
# pkg
apt-get update 
apt-get install -y libhdf5-dev locales python3-dev python3-pip python3-tk
apt-get clean

# locales
echo "LC_ALL=en_US.UTF-8" >> /etc/environment
echo "en_US.UTF-8 UTF-8" >> /etc/locale.gen
echo "LANG=en_US.UTF-8" > /etc/locale.conf
locale-gen en_US.UTF-8
dpkg-reconfigure locales

# TZ
export TZ="Asia/Seoul"
ln -snf /usr/share/zoneinfo/${TZ} /etc/localtime 
echo ${TZ} > /etc/timezone 
dpkg-reconfigure tzdata

export HDF5_DIR=/usr/lib/x86_64-linux-gnu/hdf5/serial/

# python
pip3 install --upgrade pip
# basic numerical tools
python3 -m pip install numpy scipy matplotlib 
# machine learning libraries
python3 -m pip install tensorflow-gpu scikit-learn  keras
# jupyter notebook
python3 -m pip install notebook ipython
# IO
python3 -m pip install openpyxl h5py pandas tables
# geodata
python3 -m pip install geopy pytz chardet networkx folium geopandas
# images
python3 -m pip install Pillow 
# web
python3 -m pip install chromium-browser selenium requests

# create some generic mount points
mkdir -p /mnt/data /mnt/input /mnt/output /mnt/ref /mnt/code /mnt/work
